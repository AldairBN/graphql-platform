{"componentChunkName":"component---src-templates-blog-article-template-tsx","path":"/blog/2021/01/10/hot-chocolate-logging","result":{"data":{"markdownRemark":{"excerpt":"Whether you are a building your first Hot Chocolate GraphQL server, or you're on the core team who built it, having an easy way to see bothâ€¦","frontmatter":{"featuredImage":null,"path":"/blog/2021/01/10/hot-chocolate-logging","title":"Log Your Queries While Building a GraphQL Server","tags":["hotchocolate","graphql","dotnet","aspnetcore"],"author":"Peter Kellner","authorImageUrl":"https://avatars3.githubusercontent.com/u/241170?s=60&v=4","authorUrl":"https://peterkellner.net","date":"January 10, 2021"},"html":"<p>Whether you are a building your first Hot Chocolate GraphQL server, or you're on the core team who built it, having an easy way to see both\nthe query you've sent to the server immediately is very helpful and valuable. Small mistakes in syntax can be easily discovered, problems with\nvariable definitions can be tricky to uncover, and just in general, having those queries at your finger tips is a big benefit while developing or running your\nHot Chocolate GraphQL server.</p>\n<h1 id=\"just-show-me-the-code\" style=\"position:relative;\"><a href=\"#just-show-me-the-code\" aria-label=\"just show me the code permalink\" class=\"anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" width=\"16\" height=\"16\"><path d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"/></svg></a>Just Show Me the Code</h1>\n<p>You can find all the code from this article in this Github repository.</p>\n<p><a href=\"https://github.com/ChilliCream/hotchocolate-examples/tree/master/blog/2021/2021-01-20-logging\">https://github.com/ChilliCream/hotchocolate-examples/tree/master/blog/2021/2021-01-20-logging</a></p>\n<p>To start logging your GraphQL server requests this is all you need to do. First, you need to create a new class in your project that implements the listener <code class=\"language-text\">DiagnosticEventListener</code>.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"84035000616367370000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`using System;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Text;\nusing HotChocolate.Execution;\nusing HotChocolate.Execution.Instrumentation;\nusing Microsoft.Extensions.Logging;\n\nnamespace Logging\n{\n    public class ConsoleQueryLogger : DiagnosticEventListener\n    {\n        private static Stopwatch _queryTimer;\n        private readonly ILogger<ConsoleQueryLogger> _logger;\n        public ConsoleQueryLogger(ILogger<ConsoleQueryLogger> logger)\n        {\n            _logger = logger;\n        }\n\n        public override IActivityScope ExecuteRequest(IRequestContext context)\n        {\n            return new RequestScope(_logger, context);\n        }\n\n        private class RequestScope : IActivityScope\n        {\n            private readonly IRequestContext _context;\n            private readonly ILogger<ConsoleQueryLogger> _logger;\n            public RequestScope\n                (ILogger<ConsoleQueryLogger> logger,\n                     IRequestContext context)\n            {\n                _logger = logger;\n                _context = context;\n                _queryTimer = new Stopwatch();\n                _queryTimer.Start();\n            }\n\n            public void Dispose()\n            {\n                if (_context.Document is not null)\n                {\n                    StringBuilder stringBuilder =\n                        new(_context.Document.ToString(true));\n                    stringBuilder.AppendLine();\n                    if (_context.Variables != null)\n                    {\n                        var variablesConcrete =\n                            _context.Variables!.ToList();\n                        if (variablesConcrete.Count > 0)\n                        {\n                            stringBuilder.\n                                AppendFormat(\\$&quot;Variables {Environment.NewLine}&quot;);\n                            try\n                            {\n                                foreach (var variableValue in _context.Variables!)\n                                {\n                                    string PadRightHelper\n                                        (string existingString, int lengthToPadTo)\n                                    {\n                                        if (string.IsNullOrEmpty(existingString))\n                                            return &quot;&quot;.PadRight(lengthToPadTo);\n                                        if (existingString.Length > lengthToPadTo)\n                                            return existingString.Substring(0, lengthToPadTo);\n                                        return existingString + &quot; &quot;.PadRight(lengthToPadTo - existingString.Length);\n                                    }\n                                    stringBuilder.AppendFormat(\n                                        \\$&quot;  {PadRightHelper(variableValue.Name, 20)} :  {PadRightHelper(variableValue.Value.ToString(), 20)}: {variableValue.Type}&quot;);\n                                    stringBuilder.AppendFormat(\\$&quot;{Environment.NewLine}&quot;);\n                                }\n                            }\n                            catch\n                            {\n                                // all input type records will land here.\n                                stringBuilder.Append(&quot;  Formatting Variables Error. Continuing...&quot;);\n                                stringBuilder.AppendFormat(\\$&quot;{Environment.NewLine}&quot;);\n                            }\n                        }\n                    }\n                    _queryTimer.Stop();\n                    stringBuilder.AppendFormat(\n                        \\$&quot;Ellapsed time for query is {_queryTimer.Elapsed.TotalMilliseconds:0.#} milliseconds.&quot;);\n                    _logger.LogInformation(stringBuilder.ToString());\n                }\n            }\n        }\n    }\n}`, `84035000616367370000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Diagnostics</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Linq</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Text</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">HotChocolate<span class=\"token punctuation\">.</span>Execution</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">HotChocolate<span class=\"token punctuation\">.</span>Execution<span class=\"token punctuation\">.</span>Instrumentation</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Microsoft<span class=\"token punctuation\">.</span>Extensions<span class=\"token punctuation\">.</span>Logging</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">Logging</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ConsoleQueryLogger</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">DiagnosticEventListener</span></span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">Stopwatch</span> _queryTimer<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span></span> _logger<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">ConsoleQueryLogger</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span></span> logger<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            _logger <span class=\"token operator\">=</span> logger<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\">IActivityScope</span> <span class=\"token function\">ExecuteRequest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IRequestContext</span> context<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">RequestScope</span><span class=\"token punctuation\">(</span>_logger<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">private</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">RequestScope</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">IActivityScope</span></span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">IRequestContext</span> _context<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token class-name\">ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span></span> _logger<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">public</span> RequestScope\n                <span class=\"token punctuation\">(</span><span class=\"token class-name\">ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span></span> logger<span class=\"token punctuation\">,</span>\n                     <span class=\"token class-name\">IRequestContext</span> context<span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{</span>\n                _logger <span class=\"token operator\">=</span> logger<span class=\"token punctuation\">;</span>\n                _context <span class=\"token operator\">=</span> context<span class=\"token punctuation\">;</span>\n                _queryTimer <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Stopwatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                _queryTimer<span class=\"token punctuation\">.</span><span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Dispose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_context<span class=\"token punctuation\">.</span>Document <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">{</span>\n                    <span class=\"token class-name\">StringBuilder</span> stringBuilder <span class=\"token operator\">=</span>\n                        <span class=\"token keyword\">new</span><span class=\"token punctuation\">(</span>_context<span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">AppendLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_context<span class=\"token punctuation\">.</span>Variables <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">{</span>\n                        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> variablesConcrete <span class=\"token operator\">=</span>\n                            _context<span class=\"token punctuation\">.</span>Variables<span class=\"token operator\">!</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToList</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>variablesConcrete<span class=\"token punctuation\">.</span>Count <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n                        <span class=\"token punctuation\">{</span>\n                            stringBuilder<span class=\"token punctuation\">.</span>\n                                <span class=\"token function\">AppendFormat</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"Variables </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">Environment<span class=\"token punctuation\">.</span>NewLine</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token keyword\">try</span>\n                            <span class=\"token punctuation\">{</span>\n                                <span class=\"token keyword\">foreach</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> variableValue <span class=\"token keyword\">in</span> _context<span class=\"token punctuation\">.</span>Variables<span class=\"token operator\">!</span><span class=\"token punctuation\">)</span>\n                                <span class=\"token punctuation\">{</span>\n                                    <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> PadRightHelper\n                                        <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> existingString<span class=\"token punctuation\">,</span> <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> lengthToPadTo<span class=\"token punctuation\">)</span>\n                                    <span class=\"token punctuation\">{</span>\n                                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">string</span><span class=\"token punctuation\">.</span><span class=\"token function\">IsNullOrEmpty</span><span class=\"token punctuation\">(</span>existingString<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                                            <span class=\"token keyword\">return</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">PadRight</span><span class=\"token punctuation\">(</span>lengthToPadTo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>existingString<span class=\"token punctuation\">.</span>Length <span class=\"token operator\">></span> lengthToPadTo<span class=\"token punctuation\">)</span>\n                                            <span class=\"token keyword\">return</span> existingString<span class=\"token punctuation\">.</span><span class=\"token function\">Substring</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> lengthToPadTo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                        <span class=\"token keyword\">return</span> existingString <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">.</span><span class=\"token function\">PadRight</span><span class=\"token punctuation\">(</span>lengthToPadTo <span class=\"token operator\">-</span> existingString<span class=\"token punctuation\">.</span>Length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                    <span class=\"token punctuation\">}</span>\n                                    stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">AppendFormat</span><span class=\"token punctuation\">(</span>\n                                        <span class=\"token interpolation-string\"><span class=\"token string\">$\"  </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\"><span class=\"token function\">PadRightHelper</span><span class=\"token punctuation\">(</span>variableValue<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> :  </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\"><span class=\"token function\">PadRightHelper</span><span class=\"token punctuation\">(</span>variableValue<span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">)</span></span><span class=\"token punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">variableValue<span class=\"token punctuation\">.</span>Type</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                    stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">AppendFormat</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">Environment<span class=\"token punctuation\">.</span>NewLine</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                <span class=\"token punctuation\">}</span>\n                            <span class=\"token punctuation\">}</span>\n                            <span class=\"token keyword\">catch</span>\n                            <span class=\"token punctuation\">{</span>\n                                <span class=\"token comment\">// all input type records will land here.</span>\n                                stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">Append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"  Formatting Variables Error. Continuing...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">AppendFormat</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">Environment<span class=\"token punctuation\">.</span>NewLine</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token punctuation\">}</span>\n                        <span class=\"token punctuation\">}</span>\n                    <span class=\"token punctuation\">}</span>\n                    _queryTimer<span class=\"token punctuation\">.</span><span class=\"token function\">Stop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">AppendFormat</span><span class=\"token punctuation\">(</span>\n                        <span class=\"token interpolation-string\"><span class=\"token string\">$\"Ellapsed time for query is </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span><span class=\"token expression language-csharp\">_queryTimer<span class=\"token punctuation\">.</span>Elapsed<span class=\"token punctuation\">.</span>TotalMilliseconds</span><span class=\"token format-string\"><span class=\"token punctuation\">:</span>0.#</span><span class=\"token punctuation\">}</span></span><span class=\"token string\"> milliseconds.\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    _logger<span class=\"token punctuation\">.</span><span class=\"token function\">LogInformation</span><span class=\"token punctuation\">(</span>stringBuilder<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Then, in your <code class=\"language-text\">startup.cs</code>, you need to subscribe to the the Hot Chocolate <code class=\"language-text\">DiagnosticEventListener</code>, which is what the above <code class=\"language-text\">ConsoleQueryLogger</code> class implements.</p>\n<p>That's done in the <code class=\"language-text\">ConfigureServices</code> method in <code class=\"language-text\">startup.cs</code>.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"25529974941204836000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public class Startup\n{\n    public void ConfigureServices(IServiceCollection services)\n    {\n        services\n            .AddRouting()\n            .AddGraphQLServer()\n            .AddQueryType<Query>()\n            .AddDiagnosticEventListener(sp =>\n              new ConsoleQueryLogger(\n                sp.GetApplicationService<ILogger<ConsoleQueryLogger>>()\n              ));\n    }\n\n    public void Configure(IApplicationBuilder app, IWebHostEnvironment env)\n    {\n        if (env.IsDevelopment()) app.UseDeveloperExceptionPage();\n\n        app.UseRouting();\n\n        app.UseEndpoints(endpoints => { endpoints.MapGraphQL(); });\n    }\n}`, `25529974941204836000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Startup</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">ConfigureServices</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IServiceCollection</span> services<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        services\n            <span class=\"token punctuation\">.</span><span class=\"token function\">AddRouting</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">AddGraphQLServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">AddQueryType</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>Query<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">AddDiagnosticEventListener</span><span class=\"token punctuation\">(</span>sp <span class=\"token operator\">=></span>\n              <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ConsoleQueryLogger</span><span class=\"token punctuation\">(</span>\n                sp<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetApplicationService</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n              <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Configure</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IApplicationBuilder</span> app<span class=\"token punctuation\">,</span> <span class=\"token class-name\">IWebHostEnvironment</span> env<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span><span class=\"token function\">IsDevelopment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> app<span class=\"token punctuation\">.</span><span class=\"token function\">UseDeveloperExceptionPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        app<span class=\"token punctuation\">.</span><span class=\"token function\">UseRouting</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        app<span class=\"token punctuation\">.</span><span class=\"token function\">UseEndpoints</span><span class=\"token punctuation\">(</span>endpoints <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> endpoints<span class=\"token punctuation\">.</span><span class=\"token function\">MapGraphQL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>For this logger to have something to do, we need to have a <code class=\"language-text\">Query</code> in our project so let's make a very simple class and put it in a file <code class=\"language-text\">Query.cs</code>.</p>\n<p>Let's assume you have in your <code class=\"language-text\">Query.cs</code> a resolver that takes a single parameter and returns a string based on a passed in parameter (like this for example).</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"41060006590692155000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`namespace logging\n{\n    public class Query\n    {\n        public Person GetPerson(bool upperCase = false)\n        {\n            return upperCase ?\n                new Person(&quot;Luke Skywalker&quot;.ToUpper(), 101) :\n                new Person(&quot;Luke Skywalker&quot;, 102);\n        }\n    }\n\n    public class Person\n    {\n        public Person(string name,int id)\n        {\n            Name = name; Id = id;\n        }\n        public string Name { get; }\n        public int Id { get; }\n    }\n}`, `41060006590692155000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">namespace</span> <span class=\"token namespace\">logging</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Query</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\">Person</span> <span class=\"token function\">GetPerson</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">bool</span></span> upperCase <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> upperCase <span class=\"token punctuation\">?</span>\n                <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Person</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Luke Skywalker\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">ToUpper</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Person</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Luke Skywalker\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">102</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Person</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">Person</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> name<span class=\"token punctuation\">,</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> id<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            Name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span> Id <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">string</span></span> Name <span class=\"token punctuation\">{</span> <span class=\"token keyword\">get</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">int</span></span> Id <span class=\"token punctuation\">{</span> <span class=\"token keyword\">get</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>When you execute the GraphQL query</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"64412779204552220000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`query person(\\$upperCase: Boolean) {\n  person(upperCase: \\$upperCase) {\n    name\n    id\n  }\n}`, `64412779204552220000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token keyword\">query</span> person<span class=\"token punctuation\">(</span><span class=\"token variable\">$upperCase</span><span class=\"token punctuation\">:</span> Boolean<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  person<span class=\"token punctuation\">(</span><span class=\"token attr-name\">upperCase</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$upperCase</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    name\n    id\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>with the associated <code class=\"language-text\">Boolean</code> variable in your POST <code class=\"language-text\">upperCase</code></p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"69818860258329200000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`{\n  &quot;upperCase&quot;: true\n}`, `69818860258329200000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"upperCase\"</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You console output will show this</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"83456537313744670000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`Executing endpoint 'Hot Chocolate GraphQL Pipeline'\ninfo: logging.ConsoleQueryLogger[0]\n\nquery person(\\$upperCase: Boolean) {\n  person(upperCase: \\$upperCase) {\n    name\n    id\n  }\n}\nVariables\nupperCase    :true  :HotChocolate.Types.BooleanType\nEllapsed time for query is 162 milliseconds.`, `83456537313744670000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Executing endpoint &#39;Hot Chocolate GraphQL Pipeline&#39;\ninfo: logging.ConsoleQueryLogger[0]\n\nquery person($upperCase: Boolean) {\n  person(upperCase: $upperCase) {\n    name\n    id\n  }\n}\nVariables\nupperCase    :true  :HotChocolate.Types.BooleanType\nEllapsed time for query is 162 milliseconds.</code></pre></div>\n<p>Notice the execution time shows as 162 milliseconds. If you execute the query again, you'll see that drop to just 1 or 2 milliseconds as now, the query, along with it's resolvers are cached by Hot Chocolate.</p>\n<p>Now, for a little more details on what's actually happening here, as well as how to log your queries using the very useful\n<a href=\"https://miniprofiler.com/dotnet/AspDotNetCore\" target=\"_blank\">MiniProfiler for ASP.NET Core</a>.</p>\n<h1 id=\"what-is-really-going-on-here\" style=\"position:relative;\"><a href=\"#what-is-really-going-on-here\" aria-label=\"what is really going on here permalink\" class=\"anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" width=\"16\" height=\"16\"><path d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"/></svg></a>What is Really Going on Here</h1>\n<p>Adding console logging is really quite simple in what is going on. It's straight forward usage of both the ASP.NET Core <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection\" target=\"_blank\">Dependency Injection</a> and <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware\" target=\"_blank\">Middleware</a> implementations.</p>\n<p>That middleware is added to our <code class=\"language-text\">startup.cs</code>.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"81166871303112180000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`.AddDiagnosticEventListener(sp =>\n  new ConsoleQueryLogger(\n    sp.GetApplicationService<ILogger<ConsoleQueryLogger>>()\n  ));`, `81166871303112180000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token punctuation\">.</span><span class=\"token function\">AddDiagnosticEventListener</span><span class=\"token punctuation\">(</span>sp <span class=\"token operator\">=></span>\n  <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ConsoleQueryLogger</span><span class=\"token punctuation\">(</span>\n    sp<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetApplicationService</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">AddDiagnosticEventListener</code> is adding to the Hot Chocolate GraphQL server a listener designed to listen for events that happen while the server is processing requests. Typically, these are diagnostic events that give us the ability to do things like capture GraphQL queries and variables while at the same time, doing something useful with them (like log them to the console).</p>\n<p>Our <code class=\"language-text\">ConsoleQueryLogger</code> receives as an injected service, the logger itself, that uses the <a href=\"https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging\" target=\"_blank\">ASP.NET Core Logging API</a>, and the built in Console logging provider, <code class=\"language-text\">AddConsole</code>.</p>\n<p>You will need to make sure that in your <code class=\"language-text\">program.cs</code> you've added <code class=\"language-text\">ConfigureLogging</code> to your <code class=\"language-text\">CreateHostBuilder</code> method. It should look similar to this.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"57327157663251250000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public static IHostBuilder\n  CreateHostBuilder(string[] args) =>\n    Host.CreateDefaultBuilder(args)\n        .ConfigureLogging(c => c.AddConsole())\n        .ConfigureWebHostDefaults(webBuilder =>\n        {\n            webBuilder.UseStartup<Startup>();\n        });`, `57327157663251250000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token return-type class-name\">IHostBuilder</span>\n  <span class=\"token function\">CreateHostBuilder</span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span> args<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    Host<span class=\"token punctuation\">.</span><span class=\"token function\">CreateDefaultBuilder</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">ConfigureLogging</span><span class=\"token punctuation\">(</span>c <span class=\"token operator\">=></span> c<span class=\"token punctuation\">.</span><span class=\"token function\">AddConsole</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">ConfigureWebHostDefaults</span><span class=\"token punctuation\">(</span>webBuilder <span class=\"token operator\">=></span>\n        <span class=\"token punctuation\">{</span>\n            webBuilder<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">UseStartup</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>Startup<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Back to our <code class=\"language-text\">ConsoleQueryLogger</code> class. The entire purpose of this class is to hook into the Hot Chocolate GraphQL processing pipeline such that we can start a timer before the query starts processing. Then, at that processing completion, the query details, the variables associated with the query and the execution time are logged.</p>\n<p>Because this method implements the Hot Chocolate <code class=\"language-text\">DiagnosticEventListener</code>, we can override the <code class=\"language-text\">ExecuteRequest</code> method which gives us a way to hook into the processing pipeline. That \"hook in\" is by way of Dependency Injection. By making the first parameter of that method an <code class=\"language-text\">IRequestContext</code>, we can get passed into this method, our GraphQL context for this request. That context contains all the details about the request including the query itself and its associated request variables.</p>\n<p>From here, we create a new <code class=\"language-text\">RequestScope</code>, that will track our entire request from start to finish in the Hot Chocolate GraphQL server. We pass into that <code class=\"language-text\">RequestScope</code>, our console logger and our newly acquired GraphQL context.</p>\n<p>Essentially, this new <code class=\"language-text\">RequestScope</code> tracks our GraphQL query from start to finish. We make use of <code class=\"language-text\">System.Diagnostics.Stopwatch</code> to time our request. We start the timer in the <code class=\"language-text\">RequestScope</code>'s constructor, and we stop it in its <code class=\"language-text\">Dispose</code> method. Because we have access to our request details, as well as the logger class, we can output our complete query to our logger on the completion of the request processing.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"30637839944424526000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`public void Dispose()\n{\n    if (_context.Document is not null)\n        _logger.LogInformation(_context.Document.ToString(true));\n}`, `30637839944424526000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Dispose</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_context<span class=\"token punctuation\">.</span>Document <span class=\"token keyword\">is</span> <span class=\"token keyword\">not</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span>\n        _logger<span class=\"token punctuation\">.</span><span class=\"token function\">LogInformation</span><span class=\"token punctuation\">(</span>_context<span class=\"token punctuation\">.</span>Document<span class=\"token punctuation\">.</span><span class=\"token function\">ToString</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You don't really need to understand all these details to use the logger, and likely, in the future you would probably get this from another <code class=\"language-text\">nuget</code> package. For now, it's interesting to see how straight forward it is to hook directly into the processing of your GraphQL request.</p>\n<h1 id=\"logging-requests-to-miniprofiler\" style=\"position:relative;\"><a href=\"#logging-requests-to-miniprofiler\" aria-label=\"logging requests to miniprofiler permalink\" class=\"anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" width=\"16\" height=\"16\"><path d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"/></svg></a>Logging Requests to MiniProfiler</h1>\n<p>Console logs are nice, but can get pretty cluttered and become unmanageable quickly. Luckily for us, there is very useful open source project that we can include for free in our apps called <a href=\"https://miniprofiler.com/dotnet/AspDotNetCore\" target=\"_blank\">MiniProfiler</a> and there is an implementation specifically written for <a href=\"https://docs.microsoft.com/en-us/aspnet/core\" target=\"_blank\">ASP.NET Core</a>.</p>\n<p>The idea is that you get a URL route you can secure on your website that lists the queries you've run and how long each one took. Typically it's something like <u><a href=\"http://localhost:5000/profiler/results-index\">http://localhost:5000/profiler/results-index</a></u>. Here is an example of us running the query we wrote earlier, multiple times.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/eb9ddbd28bb308a1a950d5298092eb4b/1bed9/MiniProfiler-Index-640.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVQY05VQ0W7EIAzr/3/hHm9ae7pCD5ImBCjtbRb0B2ZFkQnYCZnaeZacVcTMiFmTqZmkVOvB+76LIFAXTf02RSJRtZSEeQpaH14em3op67oSkXNuWRYmih0wVYW5oK6dlZJ/O6Yl2tdLEXPQdX1BvzyfEIPknKFsDcOdIMPo7LjFbylztJ9g255jDHjhvXfOhxBKx9EBI3wCeRxvMab9fieEY9u2DRpktAXJHbUDPZkZGRyz3OKQ2kx1phJSZYpY0tCjz2hyXdfnc2F/+O84Arf4OG6b/+Js7Q+JN5Iq5HUMqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MiniProfiler Index Web Page\"\n        title=\"MiniProfiler Index Web Page\"\n        src=\"/static/eb9ddbd28bb308a1a950d5298092eb4b/1bed9/MiniProfiler-Index-640.png\"\n        srcset=\"/static/eb9ddbd28bb308a1a950d5298092eb4b/f8f3a/MiniProfiler-Index-640.png 200w,\n/static/eb9ddbd28bb308a1a950d5298092eb4b/6a8a8/MiniProfiler-Index-640.png 400w,\n/static/eb9ddbd28bb308a1a950d5298092eb4b/1bed9/MiniProfiler-Index-640.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>You can drill down on each one if these queries, and see the actual query as well as the passed in variables along with their associated input data.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/6639ac942d3d8de8a02115d01be3d1a7/1bed9/MiniProfiler-Detail-640.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 43.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9ElEQVQoz5VQWW7FIAzM/Q/XCzypf1USwCwOPDZDaoIUpR+t1JEFXhjbzII+WOu0ts4haLvuchOwCsXOLgGM+2kowWiL27ZzbTHGKKmElLsQABBTKqXmknPhu7beb6PWKhHnnXNKCqp1kK21BzprLOLRWjsf6A9wKV8Y8wB6Pxd+Ed5xA+RlcoqNG/6J2SWlxMSLnMpLxk/IG1YV6vk7mMn8OxxkjnWo79LYMvX/kVkDVoJLw66tnv98gohYx7vREkpftf94fa3KCYOsJOvH4ksWVMjjOMID3vubPCYLTxgp5hJyjYXmhFueucVMTmcO5cMZ8w0VKAuZCI3IPwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MiniProfiler Detail Web Page\"\n        title=\"MiniProfiler Detail Web Page\"\n        src=\"/static/6639ac942d3d8de8a02115d01be3d1a7/1bed9/MiniProfiler-Detail-640.png\"\n        srcset=\"/static/6639ac942d3d8de8a02115d01be3d1a7/f8f3a/MiniProfiler-Detail-640.png 200w,\n/static/6639ac942d3d8de8a02115d01be3d1a7/6a8a8/MiniProfiler-Detail-640.png 400w,\n/static/6639ac942d3d8de8a02115d01be3d1a7/1bed9/MiniProfiler-Detail-640.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Just like for the <code class=\"language-text\">ConsoleQueryLogger</code> class, we need to create a similar class for our MiniProfiler to work. I've done that in our example repository and named the class <code class=\"language-text\">MiniProfilerQueryLogger</code>.</p>\n<p><a href=\"https://github.com/pkellner/hot-chocolate-query-logging/blob/main/MiniProfilerQueryLogger.cs\">https://github.com/pkellner/hot-chocolate-query-logging/blob/main/MiniProfilerQueryLogger.cs</a></p>\n<p>It also implements <code class=\"language-text\">DiagosticEventListener</code> just like <code class=\"language-text\">ConsoleQueryLogger</code> did. It gets passed in the request context, but instead of logging to the console with the <code class=\"language-text\">ILogger</code> interface and the <code class=\"language-text\">ConsoleLoggerExtension</code>, it simply calls the MiniProfiler API directly.</p>\n<p>I could have implemented it with the ILogger interface and that would have given a lot more flexibility to our logging, but that also would have added a lot more complexity, so for now, if you want to log to MiniProfiler, add this middleware to your GraphQL.</p>\n<p>We do need to install the MiniProfiler package for ASP.NET Core so let's do that at the command line with <code class=\"language-text\">nuget</code>. That command is:</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"29552042590317740000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`dotnet add package MiniProfiler.AspNetCore.Mvc`, `29552042590317740000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"dos\"><pre class=\"language-dos\"><code class=\"language-dos\">dotnet add package MiniProfiler.AspNetCore.Mvc</code></pre></div>\n<p>Then, to our <code class=\"language-text\">startup.cs</code>, we need to add several things. They are:</p>\n<p>In <code class=\"language-text\">ConfigureServices</code></p>\n<ol>\n<li>Add MVC to our app by adding the service <code class=\"language-text\">AddControllersWithViews</code></li>\n<li>Add the <code class=\"language-text\">MiniProfilerQueryLogger</code> service</li>\n<li>Add the <code class=\"language-text\">MiniProfiler</code> itself to the our services.</li>\n</ol>\n<p>In <code class=\"language-text\">Configure</code></p>\n<ol>\n<li>Add to our app builder <code class=\"language-text\">useMiniProfiler</code></li>\n</ol>\n<p>Here is our final <code class=\"language-text\">startup.cs</code>.</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"24571731462262436000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`using Microsoft.AspNetCore.Builder;\nusing Microsoft.AspNetCore.Hosting;\nusing Microsoft.Extensions.DependencyInjection;\nusing Microsoft.Extensions.Hosting;\nusing Microsoft.Extensions.Logging;\n\nnamespace logging\n{\n    public class Startup\n    {\n        public void ConfigureServices\n           (IServiceCollection services)\n        {\n            services.AddControllersWithViews();\n            services\n                .AddRouting()\n                .AddGraphQLServer()\n                .AddQueryType<Query>()\n                .AddDiagnosticEventListener(sp =>\n                    new ConsoleQueryLogger\n                        (sp.GetApplicationService\n                           <ILogger<ConsoleQueryLogger>>()))\n                .AddDiagnosticEventListener(sp =>\n                    new MiniProfilerQueryLogger());\n            services.AddMiniProfiler(options =>\n                { options.RouteBasePath = &quot;/profiler&quot;; });\n        }\n\n        public void Configure(IApplicationBuilder app,\n            IWebHostEnvironment env)\n        {\n            if (env.IsDevelopment())\n            {\n                app.UseDeveloperExceptionPage();\n            }\n\n            app.UseRouting();\n            app.UseMiniProfiler();\n            app.UseEndpoints(endpoints =>\n              { endpoints.MapGraphQL(); });\n        }\n    }\n}`, `24571731462262436000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">Microsoft<span class=\"token punctuation\">.</span>AspNetCore<span class=\"token punctuation\">.</span>Builder</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Microsoft<span class=\"token punctuation\">.</span>AspNetCore<span class=\"token punctuation\">.</span>Hosting</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Microsoft<span class=\"token punctuation\">.</span>Extensions<span class=\"token punctuation\">.</span>DependencyInjection</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Microsoft<span class=\"token punctuation\">.</span>Extensions<span class=\"token punctuation\">.</span>Hosting</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Microsoft<span class=\"token punctuation\">.</span>Extensions<span class=\"token punctuation\">.</span>Logging</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">logging</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Startup</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> ConfigureServices\n           <span class=\"token punctuation\">(</span><span class=\"token class-name\">IServiceCollection</span> services<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            services<span class=\"token punctuation\">.</span><span class=\"token function\">AddControllersWithViews</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            services\n                <span class=\"token punctuation\">.</span><span class=\"token function\">AddRouting</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">AddGraphQLServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">AddQueryType</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>Query<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">AddDiagnosticEventListener</span><span class=\"token punctuation\">(</span>sp <span class=\"token operator\">=></span>\n                    <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">ConsoleQueryLogger</span>\n                        <span class=\"token punctuation\">(</span>sp<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetApplicationService</span>\n                           <span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>ILogger<span class=\"token punctuation\">&lt;</span>ConsoleQueryLogger<span class=\"token punctuation\">></span><span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">AddDiagnosticEventListener</span><span class=\"token punctuation\">(</span>sp <span class=\"token operator\">=></span>\n                    <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">MiniProfilerQueryLogger</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            services<span class=\"token punctuation\">.</span><span class=\"token function\">AddMiniProfiler</span><span class=\"token punctuation\">(</span>options <span class=\"token operator\">=></span>\n                <span class=\"token punctuation\">{</span> options<span class=\"token punctuation\">.</span>RouteBasePath <span class=\"token operator\">=</span> <span class=\"token string\">\"/profiler\"</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Configure</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IApplicationBuilder</span> app<span class=\"token punctuation\">,</span>\n            <span class=\"token class-name\">IWebHostEnvironment</span> env<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>env<span class=\"token punctuation\">.</span><span class=\"token function\">IsDevelopment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">{</span>\n                app<span class=\"token punctuation\">.</span><span class=\"token function\">UseDeveloperExceptionPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n\n            app<span class=\"token punctuation\">.</span><span class=\"token function\">UseRouting</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            app<span class=\"token punctuation\">.</span><span class=\"token function\">UseMiniProfiler</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            app<span class=\"token punctuation\">.</span><span class=\"token function\">UseEndpoints</span><span class=\"token punctuation\">(</span>endpoints <span class=\"token operator\">=></span>\n              <span class=\"token punctuation\">{</span> endpoints<span class=\"token punctuation\">.</span><span class=\"token function\">MapGraphQL</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That's it! Now, when you run your app and do some GraphQL queries, you can browse to the URL <u><a href=\"http://localhost:5000/profiler/index-results\">http://localhost:5000/profiler/index-results</a></u> and that will give you a list of all your GraphQL requests. You can drill down on any request and see both the query itself, as well as any variables passed in with the associated value and type.</p>\n<p>Just a side note. You can run both the console logger and the MiniProfiler at the same time and both logs will work as adding listeners is additive.</p>\n<h1 id=\"possibilities-for-logging-sql-and-entity-framework\" style=\"position:relative;\"><a href=\"#possibilities-for-logging-sql-and-entity-framework\" aria-label=\"possibilities for logging sql and entity framework permalink\" class=\"anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" width=\"16\" height=\"16\"><path d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"/></svg></a>Possibilities For Logging SQL and Entity Framework</h1>\n<p>It's worth mentioning that <a href=\"https://miniprofiler.com\" target=\"_blank\">MiniProfiler</a> has been around for a long time and there are many configuring profiles available including ones for <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/ado-net-overview\" target=\"_blank\">ADO.NET</a> as well as <a href=\"https://docs.microsoft.com/en-us/ef/\" target=\"_blank\">Entity Framework Core</a>.</p>\n<p>If you've gotten everything working, it's trivial to add Entity Framework support so that inside your GraphQL requests, you can see the actual SQL sent to the server and the associated timing. Literally, all you have to do is install one <code class=\"language-text\">nuget</code> package</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"99204034018850800000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`dotnet add package MiniProfiler.EntityFrameworkCore`, `99204034018850800000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"dos\"><pre class=\"language-dos\"><code class=\"language-dos\">dotnet add package MiniProfiler.EntityFrameworkCore</code></pre></div>\n<p>And, in your <code class=\"language-text\">startup.cs</code>, change the line that adds MiniProfile as follows:</p>\n<div\n              class=\"gatsby-code-button-container\"\n              data-toaster-id=\"92017187574137800000\"\n              data-toaster-class=\"gatsby-code-button-toaster\"\n              data-toaster-text-class=\"gatsby-code-button-toaster-text\"\n              data-toaster-text=\"Copied code example\"\n              data-toaster-duration=\"3500\"\n              onClick=\"copyToClipboard(`services.AddMiniProfiler\n   (options =>\n      { options.RouteBasePath = &quot;/profiler&quot;; })\n         .AddEntityFramework();`, `92017187574137800000`)\"\n            >\n              <div\n                class=\"gatsby-code-button\"\n                data-tooltip=\"Copy\"\n              >\n                <svg class=\"gatsby-code-button-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path d=\"M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z\"/></svg>\n              </div>\n            </div>\n<div class=\"gatsby-highlight\" data-language=\"csharp\"><pre class=\"language-csharp\"><code class=\"language-csharp\">services<span class=\"token punctuation\">.</span>AddMiniProfiler\n   <span class=\"token punctuation\">(</span>options <span class=\"token operator\">=></span>\n      <span class=\"token punctuation\">{</span> options<span class=\"token punctuation\">.</span>RouteBasePath <span class=\"token operator\">=</span> <span class=\"token string\">\"/profiler\"</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n         <span class=\"token punctuation\">.</span><span class=\"token function\">AddEntityFramework</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Then, when you execute a GraphQL query that uses Entity Framework Core, you'll get results like the following. Notice that not only do you get the GraphQL query with it's variables, but also, you get all the SQL generated by Entity Framework that's run on that Query's behalf. Also notice the timing, you can see the time for the GraphQL query as well as the time for just the SQL.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 640px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d17bdf4c28b039457c0c40dc581805cf/1bed9/MiniProfiler-Detail-EF-640.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 154%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAIAAABoLHqZAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC5ElEQVQ4y51V23KcOBDli/ev8gv5jq3a+CHrsWcGDEL3CxJICJg9GiZZO7Ertk91dQno0926HappmoyxHelJD1AuhBuGwXs4DMI4zXNOxWbYnHNMCRQlGSNPFYIopdZarbVSynt/uWLbtnVdy2Bdc87LsuBVjHEcwzgmxmOYtgpBKaUxBFiM0/YDiEaiZV33gBACEuU8hzGtWSr6dTB/V3t67adGhTDFfO0N9hxI9GOIr5c1PbjTXxP/8pMcG5OGuNhpcWn18zrNq09LXrfLSyA5etnHN/KS5yebZMhlkvucn/nfyduWL9tyI6Ofk07M5+338HdUzmC6ablcPkUO8zrO+9PHyWASN0/z9hlyWrZ++BP1VTJ2EL61swzLh8l4BX9UCebT+hmyjYsIOebtw20v67b+ccavV875HcTLXuZXsh2CtAM8TLvgw5vAFf6Z6EYe46xD6pUjwnAbIALz20BhF5cxr1W55fuNnxPkg9HeWRP88J4pVOMYBx+NDT1ThErSC8YVZYIJxblW2uHTbtoU74Zx8BN8jLna20hphpK1bSeEBAOec+F9mKYIPxZMEfKVyumHulwFZqsgS9A2Y0xd16fTCXompBSCM8aQzhVA3sxVFLGOY0olB1hYdrQ94i0EkHMO+ZRS1UQej5R0ghDR1Kx9Yl3LmzMjRFKqOFNaIaFDigo6uu/BdAVynYn6fqBdJxnVTcco01IitRHClAErHo2g3//JO6CsVJi7R1qfedvKB7TQq7aT7ZPQqjBh1pYpvKh8I4cglfv2yI5nhuLgd53qmejKUlilSgvwqPwKGXB2+LeR92dxfOjv7/vDI3bN9lQLjv5NIWv3RuUxnHp1dy6EssnaSWERev1RALew18n+yr+rxT+P9HDoz7XAgWXC9p0ineRCG4Oy4c05c2m+HeixoeeaNA1mK3HyOoINk0zoXgrzfMHGlyDCcoEr5o3xbsB591iF8scs3RZzzsNwNP8DsBwAHl3uVrIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"MiniProfiler Detail EF 640\"\n        title=\"MiniProfiler Detail EF 640\"\n        src=\"/static/d17bdf4c28b039457c0c40dc581805cf/1bed9/MiniProfiler-Detail-EF-640.png\"\n        srcset=\"/static/d17bdf4c28b039457c0c40dc581805cf/f8f3a/MiniProfiler-Detail-EF-640.png 200w,\n/static/d17bdf4c28b039457c0c40dc581805cf/6a8a8/MiniProfiler-Detail-EF-640.png 400w,\n/static/d17bdf4c28b039457c0c40dc581805cf/1bed9/MiniProfiler-Detail-EF-640.png 640w\"\n        sizes=\"(max-width: 640px) 100vw, 640px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"wrap\" style=\"position:relative;\"><a href=\"#wrap\" aria-label=\"wrap permalink\" class=\"anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" width=\"16\" height=\"16\"><path d=\"M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z\"/></svg></a>Wrap</h1>\n<p>Once you have logging enabled in your Hot Chocolate GraphQL server, you'll wonder how you ever worked without it. It's easy to setup and does not get in the way at all while you're building your apps.</p>\n<p>Stay Safe.</p>","fields":{"readingTime":{"text":"10 min read"}}},"site":{"siteMetadata":{"siteUrl":"https://chillicream.com","author":"Chilli_Cream"}}},"pageContext":{}},"staticQueryHashes":["1014893094","2890364758","4218812017"]}